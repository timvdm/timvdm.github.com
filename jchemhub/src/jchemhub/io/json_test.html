<!DOCTYPE html>
<!--TODO: License and copyright-->
<html>
<head>
<title>jchemhub unit test-json.js</title>
<script src="../../third-party/closure/closure/goog/base.js"></script>
<script src="../deps.js"></script>
<script>
	goog.require('goog.testing.jsunit');
	goog.require('jchemhub.io.json');
	goog.require('goog.json.Serializer');
</script>
<script src="json_test_mol.js"></script>
<script src="json_test_rxn.js"></script>
<script><!--
 	var rxn;
 	var mol;
  	function setUp() {
  	}

 
  	function test0ReadMolecule() {
	  	var mol = jchemhub.io.json.readMolecule(jmol);
	  	assertEquals(mol.name,"test");
	  	assertEquals(mol.countAtoms(), 26);
	  	assertEquals(mol.countBonds(), 27);

	  	// test the string representation
	  //	var str = goog.json.Serializer.serialize(mol);
	  //	mol = goog.json.unsafeParse( str );
	  //	assertEquals(mol.name,"test");
	  //	assertEquals(mol.countAtoms(), 26);
	  //	assertEquals(mol.countBonds(), 27);
	}
	
	 function testReadMoleculeAromatic() {
	  	mol = jchemhub.io.json.readMolecule(jmol2);
	  	assertEquals(mol.name,"test");
	  	assertEquals(mol.countAtoms(), 26);
	  	assertEquals(mol.countBonds(), 27);
	}
	
  	function test1ExportMol() {
	  	mol = jchemhub.io.json.readMolecule(jmol);
	  	jmolstr = jchemhub.io.json.writeMolecule(mol);
	  	assertEquals(3366, jmolstr.length);
	  	// test the string representation
	  	var mol = jchemhub.io.json.readMolecule( JSON.stringify(jmol) );
	  	jmolstr = jchemhub.io.json.writeMolecule(mol);
	  	assertEquals(3366, jmolstr.length);
	}
	
	function test2ImportReaction() {
		rxn = jchemhub.io.json.readReaction(jreaction);
		assertEquals(rxn.header, "3-component UGI");
		assertEquals(rxn.reactants.length, 3);
		assertEquals(rxn.reactants[1].name, "isocyanoethane");
		assertEquals(rxn.reactants[1].countAtoms(), 4);
		assertEquals(rxn.products[0].countBonds(), 15);
		assertEquals(rxn.products.length, 1);
		// test the string representation
		rxn = jchemhub.io.json.readReaction( JSON.stringify(jreaction) );
		assertEquals(rxn.header, "3-component UGI");
		assertEquals(rxn.reactants.length, 3);
		assertEquals(rxn.reactants[1].name, "isocyanoethane");
		assertEquals(rxn.reactants[1].countAtoms(), 4);
		assertEquals(rxn.products[0].countBonds(), 15);
		assertEquals(rxn.products.length, 1);
	}
	
  	function test3ExportReaction() {
	  	rxn = jchemhub.io.json.readReaction(jreaction);
		var jrxnstr = jchemhub.io.json.writeReaction(rxn);
		assertEquals(3908, jrxnstr.length);
		// test the string representation
		var rxn = jchemhub.io.json.readReaction( JSON.stringify(jreaction) );
		var jrxnstr = jchemhub.io.json.writeReaction(rxn);
		assertEquals(3908, jrxnstr.length);
		
	}
	
	function test4ReactionToJson(){
		var rxn = jchemhub.io.json.readReaction(reactionDrawing);
		var rxn_json = jchemhub.io.json.reactionToJson(rxn);
		assertEquals(rxn.reactants.length, rxn_json.reactants.length);
		assertEquals(rxn.products.length, rxn_json.products.length);
		assertEquals(rxn.reactants[0].countAtoms(), rxn_json.reactants[0].atoms.length);
	}
--></script>
</head>
<body>
</body>
</html>
